# review

Claude Code による、Claude Code のためのレビュワー

## コンセプト

「レビュワーは作業者の上位存在」として設計する。

作業者 Claude Code が判断に迷って質問を投げかけたとき、ユーザーの代わりにレビュワー Claude Code が回答する。

## アーキテクチャ

```
┌─────────────────────────────────────────────┐
│            レビュワー Claude Code            │
│  - プロジェクト全体の方針を把握              │
│  - 作業者の質問に回答                        │
│  - コード編集権限なし（読み取り専用）        │
└─────────────────────────────────────────────┘
                    ↑ 質問 / ↓ 回答
┌─────────────────────────────────────────────┐
│             プロキシ (本ツール)              │
│  - 作業者の標準出力を監視                    │
│  - 質問を検出してレビュワーに転送            │
│  - 回答を作業者の標準入力に返す              │
└─────────────────────────────────────────────┘
                    ↑ 回答 / ↓ 質問
┌─────────────────────────────────────────────┐
│             作業者 Claude Code               │
│  - 実際のコード編集を担当                    │
│  - 判断に迷ったら質問                        │
└─────────────────────────────────────────────┘
```

## 設計判断

### コンテキスト共有: 質問文 + 関連ファイルのみ

全コンテキストを渡すのは冗長。レビュワーには必要十分な情報のみを渡す。

### 無限ループ防止: レビュワーは `--no-input` モードで起動

レビュワーが質問を返すと無限ループになる可能性がある。`--no-input` フラグで質問不可にして、確実に回答を返させる。

### 権限分離: レビュワーは読み取り専用

責務を分離する。コード編集は作業者の仕事であり、レビュワーは方針決定のみを担う。

## 使い方

```bash
# 通常のClaude Code
claude "新機能を実装して"

# レビュワー付きで実行
review "新機能を実装して"
# → 作業者が質問 → レビュワーが自動回答 → 作業継続
```

## 実装

- 言語: Go
- PTYを使って作業者Claude Codeの標準入出力を制御
- 質問検出後、レビュワーを `claude -p "..." --no-input --allowedTools Read,Glob,Grep` で起動
